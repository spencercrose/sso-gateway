# sso-gateway/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ssoGateway.fullname" . }}-global-conf
  labels:
    {{- include "ssoGateway.labels" . | nindent 4 }}
    app.kubernetes.io/component: global-conf
type: Opaque
data:
  # SSO_SESSION_SECRET - autogenerated
  ssoSessionSecret: |-
    {{ randAlphaNum 32 | b64enc }} 

  # SSO_REDIS_CONNECT_PASSWORD - conditionally generate or use provided value
  redisPassword: |-
    {{- if and .Values.redis.password.generate (not .Values.redis.password.value)}}
    {{ randAlphaNum (.Values.redis.password.length | int) | b64enc }}
    {{- else}}
    {{ .Values.redis.password.value | b64enc }}
    {{- end }}
